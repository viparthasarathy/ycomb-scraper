<html><head><meta name="referrer" content="origin"></meta><link rel="stylesheet" type="text/css" href="news.css?zD6eqRMybAklGlUX10Lb"></link><link rel="shortcut icon" href="favicon.ico"></link><script type="text/javascript">
function byId(id) {
  return document.getElementById(id);
}

function vote(node) {
  var v = node.id.split(/_/);   // {'up', '123'}
  var item = v[1];

  // hide arrows
  byId('up_'   + item).style.visibility = 'hidden';
  byId('down_' + item).style.visibility = 'hidden';

  // ping server
  var ping = new Image();
  ping.src = node.href;

  return false; // cancel browser nav
} </script><title>How does ActiveRecord#find work? | Hacker News</title></head><body><center><table id="hnmain" op="item" border="0" cellpadding="0" cellspacing="0" width="85%" bgcolor="#f6f6ef"><tr><td bgcolor="#ff6600"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="padding:2px"><tr><td style="width:18px;padding-right:4px"><a href="http://www.ycombinator.com"><img src="y18.gif" width="18" height="18" style="border:1px #ffffff solid;"></img></a></td><td style="line-height:12pt; height:10px;"><span class="pagetop"><b><a href="news">Hacker News</a></b><img src="s.gif" height="1" width="10"><a href="newest">new</a> | <a href="newcomments">comments</a> | <a href="show">show</a> | <a href="ask">ask</a> | <a href="jobs">jobs</a> | <a href="submit">submit</a></span></td><td style="text-align:right;padding-right:4px;"><span class="pagetop"><a href="login?whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">login</a></span></td></tr></table></td></tr><tr style="height:10px"></tr><tr><td><table border="0"><tr><td><center><a id="up_9004631" href="vote?for=9004631&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9004631"></span></center></td><td class="title"><span class="deadmark"></span><a href="https://www.omniref.com/ruby/gems/activerecord/4.2.0/symbols/ActiveRecord::Core::ClassMethods/find?#annotation=4071448&amp;line=126">How does ActiveRecord#find work?</a><span class="sitebit comhead"> (omniref.com)</span></td></tr><tr><td colspan="1"></td><td class="subtext"><span class="score" id="score_9004631">36 points</span> by <a href="user?id=myShoggoth">myShoggoth</a> 9 hours ago  | <a href="item?id=9004631">13 comments</a></td></tr><tr style="height:10px"></tr><tr><td></td><td><form method="post" action="comment"><input type="hidden" name="parent" value="9004631"><input type="hidden" name="whence" value="item?id=9004631"><input type="hidden" name="hmac" value="f6434b79f5841c3ed3ad01bda7ca8f65b3105f2d"><textarea name="text" rows="6" cols="60" style="" placeholder=""></textarea><br><br>
<input type="submit" value="add comment"></form></td></tr></table><br><br>
<table border="0"><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="0"></td><td valign="top"><center><a id="up_9007103" href="vote?for=9007103&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007103"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=jerhinesmith">jerhinesmith</a> 3 hours ago  | <a href="item?id=9007103">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">I really appreciate what the omniref guys are doing, but I find these &quot;posts&quot; (maybe not the right word?) incredibly difficult to follow.  I can&#x27;t tell if I&#x27;m supposed to read the left pane, the right pane, the bubble?  Do I click the quote bubbles?  Does the left pane &quot;track&quot; the right pane?</font></span><p><font size="1"><u><a href="reply?id=9007103&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="40"></td><td valign="top"><center><a id="up_9007206" href="vote?for=9007206&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007206"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=jordanpg">jordanpg</a> 2 hours ago  | <a href="item?id=9007206">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">A little hard to follow?  Only because I&#x27;ve never seen it before.  This is a <i>great</i> idea.<p>The publishing of code-as-narrative or code alongside narrative is something that will slip into the mainstream, maybe in our lifetimes.<p>Already, ruby code (and other similar languages) are nearly understandable by non-technical folks.  And consider the popularity of tools like cucumber that involve tests that are readable by anyone.<p>Imagine a day when code is published on the New York Times homepage, alongside some Silicon Valley luminary&#x27;s commentary.</font></span><p><font size="1"><u><a href="reply?id=9007206&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="40"></td><td valign="top"><center><a id="up_9007135" href="vote?for=9007135&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007135"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=timr">timr</a> 2 hours ago  | <a href="item?id=9007135">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">In this case, the &quot;bubble&quot; is the thing...but yeah, it&#x27;s a little noisy. Perhaps if we fuzzed out the background a bit when the annotation viewer (the bubble) is open it would help?</font></span><p><font size="1"><u><a href="reply?id=9007135&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="80"></td><td valign="top"><center><a id="up_9007540" href="vote?for=9007540&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007540"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=djloche">djloche</a> 36 minutes ago  | <a href="item?id=9007540">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">I think the thing to do might be to detect if the page was loaded with the annotation open, then fuzz background. Otherwise, you know what you&#x27;re looking at and explicitly clicked the open annotation button.<p>It&#x27;s great that the site supports such deep linking.</font></span><p><font size="1"><u><a href="reply?id=9007540&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="80"></td><td valign="top"><center><a id="up_9007154" href="vote?for=9007154&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007154"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=simoncion">simoncion</a> 2 hours ago  | <a href="item?id=9007154">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">Please don&#x27;t do this. It was immediately obvious to me which part was the part I was supposed to read. (And I&#x27;ve never visited this site before today!)</font></span><p><font size="1"><u><a href="reply?id=9007154&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="120"></td><td valign="top"><center><a id="up_9007179" href="vote?for=9007179&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007179"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=timr">timr</a> 2 hours ago  | <a href="item?id=9007179">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">Hah...we&#x27;ll put it in the &quot;maybe&quot; folder for now.</font></span><p><font size="1"><u><a href="reply?id=9007179&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="120"></td><td valign="top"><center><a id="up_9007434" href="vote?for=9007434&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007434"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=gofuckyourself">gofuckyourself</a> 1 hour ago  | <a href="item?id=9007434">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#888888">Asking him to disregard the earlier request simply because of _you_ were able to read it is disgustingly selfish. Part of providing a great user experience is about accommodating many, not just the special snowflakes like yourself.<p>It&#x27;s sad that timr put it on the back burner so quickly.</font></span><p><font size="1"><u><a href="reply?id=9007434&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="0"></td><td valign="top"><center><a id="up_9006989" href="vote?for=9006989&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9006989"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=aturek">aturek</a> 3 hours ago  | <a href="item?id=9006989">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">Here&#x27;s an optimization that one of the maintainers of rails is doing (has already done?) on #find<p><a href="http://tenderlovemaking.com/2014/02/19/adequaterecord-pro-like-activerecord.html" rel="nofollow">http:&#x2F;&#x2F;tenderlovemaking.com&#x2F;2014&#x2F;02&#x2F;19&#x2F;adequaterecord-pro-li...</a></font></span><p><font size="1"><u><a href="reply?id=9006989&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="40"></td><td valign="top"><center><a id="up_9007186" href="vote?for=9007186&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007186"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=tinco">tinco</a> 2 hours ago  | <a href="item?id=9007186">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">The second step in the omniref story is precisely the optimization Aaron made.<p>It&#x27;s the `s = find_by_statement_cache[key] || ..` statement.</font></span><p><font size="1"><u><a href="reply?id=9007186&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="40"></td><td valign="top"><center><a id="up_9007176" href="vote?for=9007176&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007176"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=weaksauce">weaksauce</a> 2 hours ago  | <a href="item?id=9007176">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">that was added as art of rails 4.2.0</font></span><p><font size="1"><u><a href="reply?id=9007176&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="0"></td><td valign="top"><center><a id="up_9006896" href="vote?for=9006896&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9006896"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=timr">timr</a> 4 hours ago  | <a href="item?id=9006896">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">Hi, author of the post here -- I actually skipped a few steps in this code, because it was getting quite long. As it turns out, ActiveRecord is amazingly complicated, even for the simplest of queries.<p>It&#x27;s trying to build an AST for every query, and that AST uses Arel, which is its own, complex layer of abstraction. There are a lot of layers of turtles before you get to anything that looks like SQL.</font></span><p><font size="1"><u><a href="reply?id=9006896&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="0"></td><td valign="top"><center><a id="up_9007219" href="vote?for=9007219&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007219"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=jordanpg">jordanpg</a> 2 hours ago  | <a href="item?id=9007219">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">Is there an Omniref equivalent for Java?</font></span><p><font size="1"><u><a href="reply?id=9007219&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr><tr><td><table border="0"><tr><td><img src="s.gif" height="1" width="40"></td><td valign="top"><center><a id="up_9007267" href="vote?for=9007267&amp;dir=up&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31"><div class="votearrow" title="upvote"></div></a><span id="down_9007267"></span></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px; "><span class="comhead"><a href="user?id=timr">timr</a> 2 hours ago  | <a href="item?id=9007267">link</a><span class="deadmark"></span></span></div><br>
<span class="comment"><font color="#000000">There will be...as soon as we build it. ;-)<p>(seriously, though: vote registered for Java as our next language.)</font></span><p><font size="1"><u><a href="reply?id=9007267&amp;whence=%69%74%65%6d%3f%69%64%3d%39%30%30%34%36%33%31">reply</a></u></font></td></tr></table></td></tr></table><br><br>
</td></tr><tr><td><img src="s.gif" height="10" width="0"><table width="100%" cellspacing="0" cellpadding="1"><tr><td bgcolor="#ff6600"></td></tr></table><br>
<center><span class="yclinks"><a href="newsguidelines.html">Guidelines</a> | <a href="newsfaq.html">FAQ</a> | <a href="mailto:hn@ycombinator.com">Support</a> | <a href="lists">Lists</a> | <a href="bookmarklet.html">Bookmarklet</a> | <a href="dmca.html">DMCA</a> | <a href="http://www.ycombinator.com/">Y Combinator</a> | <a href="http://www.ycombinator.com/apply/">Apply</a> | <a href="http://www.ycombinator.com/contact/">Contact</a></span><br><br>
<form method="get" action="//hn.algolia.com/">Search: <input type="text" name="q" value="" size="17"></form></center></td></tr></table></center></body></html>